/*
 *
 * REA Group User Interface Library
 * REA Header
 * REA Site navigation
 *
  ---------------------------------------------------------------------------------------------------------------------------------------------------- */
@import "resi-base.scss";

$desktopShrinkHeaderHeight : 72px;
$mobileHeaderHeight : 36px;
$desktopHeaderLeaderboardHeight: 174px;
$desktopHeaderHomepageHeight: 154px;

$navigationHeight: 72px;

@mixin safari-transition-fix(){
  webkit-backface-visibility: hidden;
  -webkit-transform: translateZ(0);
}

@mixin shrunk-header($media) {
  .rui-main-nav,#rui-site-links{
    opacity:0;
    z-index: -1;
    transition-duration:.2s;
  }
  .rui-main-logo{
    display: inline-block;
    width: 156px;
    margin-left: -78px;
  }
  .rui-nav-container {
    text-align: center;
  }
  .rui-nav-container{
    height: auto;
  }
  .rui-burger-toggle{
    visibility: visible;
  }
  @if $media == mobile {
    .rui-main-logo{
      top: 0;
    }
    .rui-header-container{
      height: $mobileHeaderHeight;
    }
    .rui-myrea-nav{
      padding-bottom: 10px;
    }
    .rui-burger-toggle{
      top: 3px;
      @include respond-to(phone-landscape-and-smaller) {
        left: $gridPadding;
      }
    }
  }@else if $media == desktop {
    .rui-main-logo{
      top: 22px;
    }
    .rui-header-container{
      height:$desktopShrinkHeaderHeight;
    }
  }
}
@include keyframes('fadeInAndMoveLogo') {
  0% {
    opacity:1;
    left:$gridPadding;
    margin-left: 0;
    top:34px;
    width: 232px;
  }
  20% {
    left:$gridPadding;
    margin-left: 0;
    opacity:0;
    top:34px;
    width: 232px;
  }
  21% {
    opacity:0;
    left:50%;
    margin-left: -78px;
    top: 20px;
    width: 156px;
  }
  100% {
    left:50%;
    margin-left:-78px;
    opacity:1;
    top: 20px;
  }
}
//Prevent any preload animation while the dom loads
.rui-preload *{
  -webkit-transition: none !important;
  -moz-transition: none !important;
  -ms-transition: none !important;
  -o-transition: none !important;
}
@media only screen and (min-width: 2000px) {
  .rui-header .rui-grid{
    /*Problem with safari when the browser window is larger then 2000px a flicker occurs in animation*/
    @include safari-transition-fix();
  }
}
.rui-header {
  border-bottom: 1px solid $borderColor;
  background:#fff;
  text-align:left;
  line-height:0;
  position: fixed;
  z-index: 21;
  top:0;
  left:0;
  width:100%;
  .rui-grid{
    max-width:$desktop - ($gridPadding*2);
    padding: 0 $gridPadding;
  }
  @media only screen and (min-width: $tabletPortrait) {
    -webkit-transform: translateZ(0);
    -webkit-backface-visibility: hidden;
  }
  &.rui-header-not-fixed{
    position:absolute;
    min-width:$desktop;
    border-bottom: 1px solid $borderColor;
    .rui-responsive &{
      min-width:100%;
    }
  }
  .rui-cobranded &{
    position: relative;
    .rui-header-container{
      position: static;
      height: auto;
      width:$desktop;
    }
    .rui-main-nav{
      position: static;
    }
    .rui-main-nav,.rui-myrea-nav{
      padding-top: 15px;
    }
    .rui-myrea-nav{
      position:relative;
      float:right;
      .rui-account-menu-container{
        bottom: -16px;
      }
    }
  }
  a{
    text-decoration: none;
  }
  .rui-header-container{
    position: relative;
    height: 156px;
    transition-property: opacity, height;
    transition-duration: .3s, .3s;
  }
  .rui-nav-container{
    display: block;
    height: auto;
    position: relative;
  }

  .rui-header-container,.rui-nav-container{
    width:$desktop - ($gridPadding*2);
  }
  .rui-responsive &{
    .rui-header-container,.rui-nav-container{
      width:auto;
    }
  }
  .rui-main-logo{
    margin:auto;
    display:block;
    width: 232px;
    height: 42px;
    background-size: 232px 42px;
    position: absolute;
    top: 34px;
    left:50%;
    margin-left:-115px;
    z-index: 2;
    body:not(.rui-leaderboard-layout) &{
      transition-duration: .3s;
    }
  }
  hr.rui-clearboth{
    content: "";
    display: block;
    height: 1px;
    opacity:0;
    z-index: -1;
    background: $borderColor;
    position: absolute;
    width:100%;
    visibility: visible;
  }
  &.rui-header-shrink hr.rui-clearboth{
    opacity:1;
    transition-delay: .3s;
    transition-duration: 0s;
  }
  .rui-person-guy{
    color: #333;
    text-decoration: none;
    font-size: 24px;
    .ie8 &{
      font-size: 28px;
    }
    line-height: 24px;
    height: 24px;
    z-index: 1;
    display:block;
    position: relative;
    &:before{
      margin-right: 0.5em;
    }
    &.rui-icon-user-off.rui-toggle-open:after{
      border-bottom-color: #000;
      border-top-color:transparent;
      top:7px;
    }
  }
  .rui-burger-toggle.rui-desktop{
    .rui-burger-open &{
      color:$reaRed;
    }
    span.rui-visuallyhidden{
      font-family: 'Museo-Sans-500', helvetica, arial, sans-serif;
      font-size: 0.71em;
      letter-spacing: 0.5px;
      position:relative;
      top:-3px;
    }
    outline-width: 0;
  }
  .rui-burger-toggle {
    position: absolute;
    transition-duration: .2s;
    top: 25px;
    display:none;
    //Setting the rules for the burger buttons under their respective media queries the burgers are shown via opacity
    //So we can animate them in and out
    &.rui-desktop{
      display:block;
      opacity:0;
      .ie8 &{
        visibility: visible;
      }
    }
    /*
      Important's are used here to enforce displays of burger menus under different media queries.
      I.e Mobile resolutions will only ever display mobile burgers and same for desktop.
      opacities however are used to render the animations for the different states.
    */
    &.rui-mobile{
      display:none !important;
    }
    @include respond-to(tablet-portrait-and-smaller) {
      &.rui-desktop{
        display:none !important;
      }
      &.rui-mobile{
        display:block !important;
      }
    }
  }
  .rui-main-nav,#rui-site-links{
    opacity:1;
    position: absolute;
    transition-duration:1s;
  }
  .rui-mobile-icons{
    display: none;
  }
  //Both main nav and sub nav use almost the same styles
  @mixin navFont(){
    span{
      padding: 0 14px;
      font-family: 'Museo-Sans-500', helvetica, arial, sans-serif;
      font-size: 0.875em;
      cursor: pointer;
    }
    a,span{
      display: block;
      line-height: $navigationHeight;
    }
    a{
      color: #484848;
    }
    &.rui-nav-active a,&:hover a{
      color:$reaRed;
    }
    &:first-child{
      a span{
        padding-left:0;
      }
    }
  }
  .rui-main-nav{
    position: absolute;
    bottom: 0px;
    .rui-nav-tab{
      //floating rather then inline blocking due to inherit left and right margins needs to be precise for responsiveness
      float:left;
      @include navFont();
    }

  }
  .rui-sub-nav{
    border-top:solid 1px $borderColor;
    background-color:#fcfcfc;
    width:100%;
    overflow: auto;
    ul{
      text-align: center;
      width:990px;
      margin: auto;
      overflow:auto;
    }
    .rui-nav-tab{
      display: inline-block;
      @include navFont();
      //Override the subnav font
      span{
        line-height: 42px;
        text-transform:none;
      }
    }

  }

  //Target Ipads and smaller
  @include respond-to(wide-screens-and-smaller) {
    //When the header is shrunk and the nav items are in dropdown menu
    .rui-responsive &.rui-header-shrink .rui-main-nav .rui-nav-tab span{
      padding: 0 11px;
    }
    //When the header is not shrunk
    .rui-responsive &:not(.rui-header-shrink) .rui-main-nav .rui-nav-tab span{
      padding: 0 8px;
      font-size: 12px;
    }
    .rui-responsive &:not(.rui-header-shrink) .rui-main-nav .rui-nav-tab:first-child a span{
      padding-left:0;
    }
  }
  //Responsive Styles
  @include respond-to(wide-screens) {
    .rui-responsive &:not(.rui-header-shrink) .rui-main-nav .rui-nav-tab span{
      padding: 0px 12px 0px 12px;
      font-size:12px;
    }
  }
  @media only screen and (max-width: 800px) {
    .rui-responsive &.rui-header-shrink .rui-main-nav .rui-nav-tab span{
      padding: 0 6px;
    }
    .rui-responsive &:not(.rui-header-shrink) .rui-main-nav .rui-nav-tab span{
      padding: 0 6px;
    }
  }
  @media only screen and (max-width: 750px) {
    .rui-responsive &:not(.rui-header-shrink) .rui-main-nav .rui-nav-tab span{
      padding: 0 5px;
    }
  }

  @include respond-to(tablet-landscape-and-smaller) {
    .rui-responsive &{
      .rui-myrea-nav{
        .rui-button-brand{
          padding-top:11px;
          padding-bottom:11px;
        }
      }
    }
  }
  //In desktop mode the header will shrink after the user scrolls
  &.rui-header-shrink{
    @include shrunk-header('desktop');
    .rui-burger-toggle{
      opacity:1;
      .ie8 & {
        display: block;
        visibility: visible;
      }

    }
    .rui-nav-container {
      .rui-main-nav,.rui-sub-nav{
        height:0;
        overflow: hidden;
        position: relative;
        ul{
          display: inline-block;
        }
      }
      z-index: 22;
    }
    //Opened Nav Container (potentially belongs in burger.css)
    .rui-burger.rui-burger-open &{
      .rui-nav-container {
        top:1px;
        .rui-sub-nav,.rui-main-nav{
          left:-1px;
          height:$navigationHeight;
          opacity:1;
          bottom: 0;
        }
      }
    }
    .rui-sub-nav{
      ul{
        text-align: center;
      }
    }
    .rui-burger-open:not(.ie8) & {
      border-bottom:none;
      box-shadow:rgba(0,0,0,.1) 0px 4px 0px;
    }
  }
  //Target Mobile
  @include respond-to(tablet-portrait-and-smaller) {
    .rui-responsive &{
      @include shrunk-header('mobile');
      .rui-main-nav {
        display: none;
      }
      .rui-main-logo {
        margin-bottom: 0;
        height: auto;
        width: 140px;
        margin-left:-70px;
      }
      &,&.rui-header-shrink {
        .rui-burger-toggle{
          opacity:1;
          z-index: 1;
        }
      }
      .rui-nav-container{
        position: static;
      }
      #rui-site-links{
        display: none;
      }
      .rui-burger-toggle.rui-mobile{
        span:first-child{
          display: none;
        }
      }
      hr.rui-clearboth{
        display: none;
      }
      & {
        //Needs to be static as long as the html menu is placed within the header for mobile
        position: static;
        padding-top: 12px;
      }
      .rui-mobile-icons{
        top: 3px;
        right: 15px;
        position: absolute;
        line-height: normal;
        font-size: 1.2em;
        display: block;
        color: #697684;
      }
    }
  }
  //Header changes when there is a leaderboard
  .rui-leaderboard-layout &{
    .rui-header-container{
      height: $desktopHeaderLeaderboardHeight;
      position: relative;
    }
    #rui-site-links{
      display: none;
    }
    .rui-leaderboard {
      position: absolute;
      right:0px;
      top:15px;
      display: block;
      line-height: 0;
      font-size: 0;
      transition-delay:.3s;
      transition-duration:.3s;
      background: #fff;
      border:none;
    }
    .rui-main-logo{
      left:$gridPadding;
      margin-left: 0;
    }
    .rui-burger-toggle{
      transition-duration:0s;
    }
    &.rui-header-shrink{
      .rui-main-logo{
        left:50%;
        margin-left:-78px;
        @include animate(fadeInAndMoveLogo,1s);
      }
      .rui-leaderboard {
        left: 247px;
        top: -105px;
        position: relative;
        transition-delay:.05s;
        transition-duration:.05s;
      }
      .rui-burger-toggle{
        transition-delay:.3s;
        transition-duration:.5s;
      }
      .rui-header-container{
        height: $desktopShrinkHeaderHeight;
      }
    }
    .rui-myrea-nav{
      z-index: 10;
    }
  }
  .rui-leaderboard-container {
    border-bottom: 1px solid $borderColor;
    padding: 20px 0;
    @include respond-to(tablet-portrait-and-smaller) {
      display: none;
    }
    > * {
      margin: 0 auto;
    }
  }
}


/* Due to fixed position header we need to apply top padding on main content block */
body {
  clear: both;
  padding-top: 157px;
  text-align:left;
  //Unfortunately we need to set the paddings of the body containers manually due to fixed position heading
  &.rui-leaderboard-layout {
    padding-top:175px;
  }
  &.rui-responsive-leaderboard-layout {
    padding:0;
    .rui-header{
      @media(min-width: $tabletPortrait) {
        position: relative;
      }
    }
  }
  &.rui-has-sub-nav {
    padding-top:201px;
  }
  &.rui-has-sub-nav.rui-leaderboard-layout {
    padding-top:220px;
  }
  &.rui-cobranded{
    padding-top: 0;
  }
  .rui-body-content{
    padding-top:30px;
  }
  @include respond-to(tablet-portrait-and-smaller) {
    &.rui-responsive {
      padding-top: 0px;
    }
  }
}

.rui-header-mobile-only{
  @media only screen and (min-width: $tabletPortrait + 1) {
    display: none!important;
    visibility: hidden!important;
  }
}

/* Goes around ads for legacy grids to add the 10px (ad column is 310px wide) */
.rui-image-wrapper {
  border: 5px solid #eee;
  display: block;
  vertical-align: bottom;
  margin-bottom: 20px;
}

//Because IE 8 doesnt play nice with opacity and there is no animation we are just going to hide the elemnents in these states
.ie8 .rui-header .rui-burger-toggle.rui-desktop,
.ie8 .rui-header-shrink #rui-site-links{
  display:none;
}
.ie8 .rui-header.rui-header-shrink .rui-burger-toggle.rui-desktop{
  display: block;
}

// Dealing with different kerning and spacing in IE with Museo Sans
.ie .rui-main-nav .rui-nav-tab a span {
  letter-spacing: -0.4px;
}

.ie8 hr.rui-clearboth{
  display:block;
}
.ie8 hr.rui-clearboth{
  display:none;
}
.ie8 .rui-header-shrink hr.rui-clearboth{
  display:block;
}